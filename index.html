<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>üí∞ –ù–∞—à –ë—é–¥–∂–µ—Ç - –°–æ–≤–º–µ—Å—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#6d28d9" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="–ù–∞—à –ë—é–¥–∂–µ—Ç" />
    <link rel="manifest" href="manifest.json" />
    
    <!-- Favicon –∏ –∏–∫–æ–Ω–∫–∏ -->
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="icons/icon-32x32.svg" />
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="icons/icon-16x16.svg" />
    <link rel="apple-touch-icon" href="icons/icon-192x192.svg" />
    
    <!-- –ú–û–ë–ò–õ–¨–ù–ê–Ø –î–ï–¢–ï–ö–¶–ò–Ø - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–µ—Ä–≤–æ–π -->
    <script src="js/mobile-detection.js"></script>
    
    <!-- –ü–†–û–°–¢–ê–Ø –ó–ê–©–ò–¢–ê - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è -->
    <script src="js/simple-protection.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Firebase SDK - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å fallback -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <!-- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π Fallback –¥–ª—è Firebase -->
    <script>
      // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ Firebase fallback
      (function() {
        function loadFirebaseFallback() {
          if (typeof firebase !== 'undefined') return;
          
          console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –≤–µ—Ä—Å–∏—é Firebase...');
          
          const script1 = document.createElement('script');
          script1.src = 'https://firebase.googleapis.com/9.22.0/firebase-app-compat.js';
          script1.async = false;
          
          const script2 = document.createElement('script');
          script2.src = 'https://firebase.googleapis.com/9.22.0/firebase-database-compat.js';
          script2.async = false;
          
          document.head.appendChild(script1);
          document.head.appendChild(script2);
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É
        setTimeout(loadFirebaseFallback, 100);
      })();
    </script>
    
    <!-- CSS –°–¢–ò–õ–ò -->
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/mobile.css" />
    <link rel="stylesheet" href="css/gradient-settings.css" />
    
    <!-- –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ï –°–¢–ò–õ–ò -->
    <style>
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
        color: #fff !important;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
        margin: 0 !important;
        min-height: 100vh !important;
      }
      .container {
        max-width: 1200px !important;
        margin: 0 auto !important;
        padding: 20px !important;
      }
      .section {
        background: rgba(255, 255, 255, 0.1) !important;
        backdrop-filter: blur(10px) !important;
        border-radius: 16px !important;
        padding: 24px !important;
        margin-bottom: 20px !important;
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
      }
    </style>
    
    <!-- –û–°–ù–û–í–ù–´–ï –°–ö–†–ò–ü–¢–´ -->
    <script src="js/app.js"></script>
    <script src="js/firebase-sync.js"></script>
    <script src="js/touch-gestures.js"></script>
    <script src="js/animations.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/gradient-settings.js"></script>
    <script src="js/quick-actions.js"></script>
  </head>
  <body>
    <!-- Burger Menu -->
    <div id="burgerButton" class="burger-button">
      <div class="burger-lines">
        <div class="burger-line"></div>
        <div class="burger-line"></div>
        <div class="burger-line"></div>
      </div>
    </div>

    <div id="burgerMenu" class="burger-menu">
      <div class="burger-menu-header">
        <h3>üîß –ú–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h3>
      </div>
      <div class="burger-menu-content">
        <button
          class="burger-item"
          onclick="openModal('incomeModal'); closeBurgerMenu();"
        >
          üí∞ –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥
        </button>
        <button
          class="burger-item"
          onclick="openModal('expenseModal'); closeBurgerMenu();"
        >
          üí∏ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥
        </button>
        <button
          class="burger-item"
          onclick="openModal('addGoalModal'); closeBurgerMenu();"
        >
          üéØ –¶–µ–ª–∏
        </button>
        <button
          class="burger-item"
          onclick="openModal('categoriesModal'); closeBurgerMenu();"
        >
          üìã –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
        </button>
        <button
          class="burger-item"
          onclick="openModal('budgetCategoriesModal'); closeBurgerMenu();"
        >
          üí≥ –ë—é–¥–∂–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        </button>
        <button
          class="burger-item"
          onclick="openModal('recurringModal'); closeBurgerMenu();"
        >
          üîÑ –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è
        </button>
        <button
          class="burger-item"
          onclick="openModal('analyticsModal'); closeBurgerMenu();"
        >
          üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
        </button>
        <button
          class="burger-item"
          onclick="openModal('settingsModal'); closeBurgerMenu();"
        >
          ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        </button>
        <button
          class="burger-item"
          onclick="showFamilyId(); closeBurgerMenu();"
        >
          üè† ID —Å–µ–º—å–∏
        </button>
      </div>
    </div>

    <div id="addGoalModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('addGoalModal')">
          &times;
        </button>
        <h2>–î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</h2>
        <p style="color: var(--text-muted)">
          –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Ü–µ–ª–∏
        </p>
        <form id="goalForm">
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏</label>
            <input type="text" class="form-control" id="goalName" required />
          </div>
          <div class="form-group">
            <label>–°—É–º–º–∞ —Ü–µ–ª–∏ (z≈Ç)</label>
            <input
              type="number"
              class="form-control"
              id="goalAmount"
              required
              min="0.01"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–¢–µ–∫—É—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è (z≈Ç)</label>
            <input
              type="number"
              class="form-control"
              id="goalCurrent"
              min="0"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–î–∞—Ç–∞ —Ü–µ–ª–∏</label>
            <input type="date" class="form-control" id="goalDate" required />
          </div>
          <div class="form-group">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ü–µ–ª–∏</label>
            <select class="form-control" id="goalCategory">
              <option value="savings">–°–±–µ—Ä–µ–∂–µ–Ω–∏—è</option>
              <option value="travel">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</option>
              <option value="home">–î–æ–º</option>
              <option value="car">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</option>
              <option value="other">–î—Ä—É–≥–æ–µ</option>
            </select>
          </div>
          <button type="submit" class="btn btn-warning" style="width: 100%">
            –°–æ–∑–¥–∞—Ç—å —Ü–µ–ª—å
          </button>
        </form>
      </div>
    </div>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div id="settingsModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('settingsModal')">
          &times;
        </button>
        <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>

        <!-- –í–∫–ª–∞–¥–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <div
          style="
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--card-border);
          "
        >
          <button
            class="settings-tab active"
            onclick="switchSettingsTab('interface')"
            data-tab="interface"
          >
            üé® –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
          </button>
          <button
            class="settings-tab"
            onclick="switchSettingsTab('background')"
            data-tab="background"
          >
            üåà –§–æ–Ω
          </button>
          <button
            class="settings-tab"
            onclick="switchSettingsTab('sync')"
            data-tab="sync"
          >
            üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
          </button>
          <button
            class="settings-tab"
            onclick="switchSettingsTab('budgets')"
            data-tab="budgets"
          >
            üí∞ –ë—é–¥–∂–µ—Ç—ã
          </button>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ -->
        <div id="interfaceSettings" class="settings-content active">
          <h3 style="color: var(--primary); margin-bottom: 15px">
            –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
          </h3>

          <div class="form-group">
            <label>–¢–µ–º–∞:</label>
            <select id="themeSelect" class="form-control">
              <option value="dark">–¢—ë–º–Ω–∞—è</option>
              <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
              <option value="gray">–°–µ—Ä–∞—è</option>
              <option value="pink">–†–æ–∑–æ–≤–∞—è</option>
            </select>
          </div>

          <div class="form-group">
            <label>–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞:</label>
            <select
              id="colorSelect"
              class="form-control"
              onchange="setColorScheme(this.value)"
            >
              <option value="default">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</option>
              <option value="green">–ó–µ–ª—ë–Ω–∞—è</option>
              <option value="blue">–°–∏–Ω—è—è</option>
              <option value="orange">–û—Ä–∞–Ω–∂–µ–≤–∞—è</option>
              <option value="gray">–°–µ—Ä–∞—è</option>
              <option value="pink">–†–æ–∑–æ–≤–∞—è</option>
            </select>
          </div>

          <div class="form-group">
            <label>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞: <span id="fontSizeLabel">16px</span></label>
            <input
              type="range"
              min="14"
              max="22"
              value="16"
              id="fontSizeRange"
              class="form-control"
              oninput="setFontSize(this.value)"
              style="width: 100%"
            />
          </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–æ–Ω–∞ -->
        <div id="backgroundSettings" class="settings-content">
          <h3 style="color: var(--primary); margin-bottom: 15px">
            –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Ñ–æ–Ω–∞
          </h3>

          <div class="form-group">
            <label>–¶–≤–µ—Ç–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞:</label>
            <div
              style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap"
            >
              <input type="color" id="color1" value="#6d28d9" />
              <input type="color" id="color2" value="#10b981" />
              <input type="color" id="color3" value="#3b82f6" />
              <input type="color" id="color4" value="#ef4444" />
              <input type="color" id="color5" value="#f59e0b" />
            </div>
          </div>

          <div class="form-group">
            <label
              >–°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏: <span id="speedValue">18</span> —Å–µ–∫</label
            >
            <input
              type="range"
              id="gradientSpeed"
              min="5"
              max="40"
              value="18"
              class="form-control"
              style="width: 100%"
              oninput="updateSpeedLabel(this.value)"
            />
          </div>

          <div class="form-group">
            <label>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞:</label>
            <select id="gradientDirection" class="form-control">
              <option value="270deg">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ</option>
              <option value="135deg">–î–∏–∞–≥–æ–Ω–∞–ª—å ‚Üó</option>
              <option value="90deg">–°–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ</option>
              <option value="180deg">–°–≤–µ—Ä—Ö—É –≤–Ω–∏–∑</option>
              <option value="45deg">–î–∏–∞–≥–æ–Ω–∞–ª—å ‚Üñ</option>
            </select>
          </div>

          <div class="form-group">
            <label for="customGradientInput"
              >–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π CSS-–≥—Ä–∞–¥–∏–µ–Ω—Ç:</label
            >
            <textarea
              id="customGradientInput"
              rows="3"
              class="form-control"
              placeholder="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
              style="margin-top: 8px"
            ></textarea>
            <button
              onclick="applyCustomGradient()"
              class="btn btn-primary"
              style="margin-top: 10px; width: 100%"
            >
              –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç
            </button>
          </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±—é–¥–∂–µ—Ç–æ–≤ -->
        <div id="budgetsSettings" class="settings-content">
          <h3 style="color: var(--primary); margin-bottom: 15px">
            üí∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞–º–∏
          </h3>

          <div class="form-group">
            <label for="budgetCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤:</label>
            <select id="budgetCategory" class="form-control">
              <option value="–ü—Ä–æ–¥—É–∫—Ç—ã">üõí –ü—Ä–æ–¥—É–∫—Ç—ã</option>
              <option value="–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç">üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</option>
              <option value="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è">üé¨ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
              <option value="–ó–¥–æ—Ä–æ–≤—å–µ">üè• –ó–¥–æ—Ä–æ–≤—å–µ</option>
              <option value="–û–¥–µ–∂–¥–∞">üëî –û–¥–µ–∂–¥–∞</option>
              <option value="–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ">üè† –ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ</option>
              <option value="–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ">üìö –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
              <option value="–ü—Ä–æ—á–µ–µ">üì¶ –ü—Ä–æ—á–µ–µ</option>
            </select>
          </div>

          <div class="form-group">
            <label for="budgetLimit">–ú–µ—Å—è—á–Ω—ã–π –ª–∏–º–∏—Ç (‚ÇΩ):</label>
            <input
              type="number"
              id="budgetLimit"
              class="form-control"
              placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ª–∏–º–∏—Ç–∞"
              min="0"
              step="100"
            />
          </div>

          <button
            onclick="addBudgetFromForm()"
            class="btn btn-primary"
            style="width: 100%; margin-bottom: 20px"
          >
            ‚ûï –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç
          </button>

          <h4 style="color: var(--primary); margin: 20px 0 10px 0">
            –¢–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã:
          </h4>
          <div id="budgetsList" style="margin-top: 10px">
            <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –±—é–¥–∂–µ—Ç—ã -->
          </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ -->
        <div id="syncSettings" class="settings-content">
          <h3 style="color: var(--primary); margin-bottom: 15px">
            üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
          </h3>
          
          <div style="background: var(--card-bg); padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid var(--card-border);">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
              <span id="syncStatusIcon">‚è≥</span>
              <strong id="syncStatusText">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...</strong>
            </div>
            <p style="color: var(--text-muted); font-size: 0.9em; margin: 0;">
              –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –æ–±–ª–∞–∫–æ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            </p>
          </div>

          <div class="form-group">
            <label for="familyIdInput">ID —Å–µ–º—å–∏ (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞):</label>
            <input
              type="text"
              id="familyIdInput"
              class="form-control"
              placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ ID —Å–µ–º—å–∏"
              style="margin-bottom: 10px;"
            />
            <button
              onclick="generateFamilyId()"
              class="btn btn-secondary"
              style="width: 100%; margin-bottom: 10px;"
            >
              üîÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π ID
            </button>
            <button
              onclick="saveFamilyId()"
              class="btn btn-primary"
              style="width: 100%;"
            >
              üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID —Å–µ–º—å–∏
            </button>
          </div>

          <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button
              onclick="forceSyncNow()"
              class="btn btn-success"
              style="flex: 1;"
            >
              üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å
            </button>
            <button
              onclick="installPWA()"
              class="btn btn-info"
              style="flex: 1;"
            >
              üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            </button>
          </div>
          


          
          <div style="display: flex; gap: 10px; margin-top: 5px;">
            <button
              onclick="resetDeletedTransactions()"
              class="btn btn-danger"
              style="flex: 1; font-size: 0.8em;"
            >
              ÔøΩÔ∏è –°–±—Ä–æ—Å–∏—Ç—å —Å–ø–∏—Å–æ–∫
            </button>
            <button
              onclick="window.location.reload(true)"
              class="btn btn-secondary"
              style="flex: 1; font-size: 0.8em;"
            >
              üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
            </button>
          </div>

          <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π -->
          <div style="background: var(--card-bg); padding: 15px; border-radius: 10px; margin: 15px 0; border: 1px solid var(--card-border);">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
              <span>üîÑ</span>
              <strong>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π</strong>
            </div>
            <p style="color: var(--text-muted); font-size: 0.9em; margin: 0 0 15px 0;">
              –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä—è–¥–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            </p>
            
            <div style="display: flex; gap: 15px; margin-bottom: 15px;">
              <div style="flex: 1;">
                <label style="display: block; margin-bottom: 5px; font-size: 0.9em;">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</label>
                <select id="transactionSortField" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid var(--card-border); background: var(--input-bg); color: var(--text);">
                  <option value="date">–î–∞—Ç–µ</option>
                  <option value="amount">–°—É–º–º–µ</option>
                  <option value="type">–¢–∏–ø—É (–¥–æ—Ö–æ–¥/—Ä–∞—Å—Ö–æ–¥)</option>
                  <option value="category">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                  <option value="description">–û–ø–∏—Å–∞–Ω–∏—é</option>
                </select>
              </div>
              
              <div style="flex: 1;">
                <label style="display: block; margin-bottom: 5px; font-size: 0.9em;">–ü–æ—Ä—è–¥–æ–∫:</label>
                <select id="transactionSortDirection" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid var(--card-border); background: var(--input-bg); color: var(--text);">
                  <option value="desc">–ü–æ —É–±—ã–≤–∞–Ω–∏—é (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)</option>
                  <option value="asc">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é (—Å—Ç–∞—Ä—ã–µ —Å–≤–µ—Ä—Ö—É)</option>
                </select>
              </div>
            </div>
            
            <button onclick="updateTransactionSorting()" class="btn btn-primary" style="width: 100%; font-size: 0.9em;">
              ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
            </button>
          </div>

          <div style="margin-top: 15px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 10px; border: 1px solid rgba(220, 53, 69, 0.3);">
            <h4 style="color: #dc3545; margin-bottom: 10px;">‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h4>
            <button
              onclick="clearAllData()"
              class="btn btn-danger"
              style="width: 100%; font-size: 0.9em; background-color: #dc3545; border-color: #dc3545;"
            >
              üóëÔ∏è –ü–û–õ–ù–ê–Ø –û–ß–ò–°–¢–ö–ê –í–°–ï–• –î–ê–ù–ù–´–•
            </button>
            <p style="color: var(--text-muted); font-size: 0.8em; margin: 10px 0 0 0; text-align: center;">
              –£–¥–∞–ª—è–µ—Ç –í–°–ï —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Ü–µ–ª–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–≤—Å–µ–≥–¥–∞!
            </p>
          </div>

          <div style="margin-top: 20px; padding: 15px; background: rgba(16, 185, 129, 0.1); border-radius: 10px; border: 1px solid rgba(16, 185, 129, 0.3);">
            <h4 style="color: #10b981; margin-bottom: 10px;">üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</h4>
            <ul style="color: var(--text-muted); font-size: 0.9em; margin: 0; padding-left: 20px;">
              <li>–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏</li>
              <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω ID —Å–µ–º—å–∏ –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</li>
              <li>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏</li>
              <li>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
    <div id="welcomeModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('welcomeModal')">
          &times;
        </button>
        <h2>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
        <p
          style="
            margin-bottom: 18px;
            color: var(--text-muted);
            font-size: 1.1em;
          "
        >
          –≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –≤–µ–¥–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–∞. –í–æ—Ç –∫–∞–∫ –Ω–∞—á–∞—Ç—å:
        </p>
        <ul
          style="margin-bottom: 18px; color: var(--text-muted); font-size: 1em"
        >
          <li>üí∞ <b>–î–æ–±–∞–≤—å—Ç–µ –¥–æ—Ö–æ–¥</b> ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –¥–µ–Ω–µ–≥.</li>
          <li>üí∏ <b>–î–æ–±–∞–≤—å—Ç–µ —Ä–∞—Å—Ö–æ–¥</b> ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ç—Ä–∞—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.</li>
          <li>
            üéØ <b>–°–æ–∑–¥–∞–π—Ç–µ —Ü–µ–ª—å</b> ‚Äî –∫–æ–ø–∏—Ç–µ –Ω–∞ –º–µ—á—Ç—É –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º.
          </li>
          <li>üìä <b>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</b> ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –≥—Ä–∞—Ñ–∏–∫–∏.</li>
          <li>
            üìã <b>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</b> ‚Äî –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–≤–æ–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤.
          </li>
        </ul>
        <button
          class="btn btn-primary"
          style="width: 100%"
          onclick="closeModal('welcomeModal')"
        >
          –ü–æ–Ω—è—Ç–Ω–æ!
        </button>
      </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –≤ –æ–±—â–µ–π –ø–∞–Ω–µ–ª–∏ -->
    <div class="container">
      <!-- –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –±–ª–æ–∫: –∑–∞–≥–æ–ª–æ–≤–æ–∫ + –±–∞–ª–∞–Ω—Å + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
      <div class="unified-header-dashboard">
        <!-- –í–µ—Ä—Ö–Ω—è—è —Å–µ–∫—Ü–∏—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–∞—Ä–µ -->
        <div class="couple-header-section">
          <div class="app-title-area">
            <div class="app-title">
              <h1>üíë –ù–∞—à –ë—é–¥–∂–µ—Ç</h1>
              <p>–°–æ–≤–º–µ—Å—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –¥–ª—è –ø–∞—Ä—ã</p>
            </div>
          </div>

          <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º -->
          <div class="couple-stats-grid">
            <div class="person-stat arthur-stat">
              <div class="person-avatar">üë®‚Äçüíª</div>
              <div class="person-info">
                <div class="person-name">–ê—Ä—Ç—É—Ä</div>
                <div class="person-amount income" id="arthurIncome">0 z≈Ç</div>
                <div class="person-period">–¥–æ—Ö–æ–¥ –∑–∞ –º–µ—Å—è—Ü</div>
              </div>
            </div>

            <div class="total-balance-display">
              <div class="balance-icon">üí∞</div>
              <div class="balance-info">
                <div class="balance-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</div>
                <div class="balance-value" id="totalBalance">0 z≈Ç</div>
                <div class="balance-status">—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</div>
              </div>
            </div>

            <div class="person-stat lera-stat">
              <div class="person-avatar">üë©‚Äçüíª</div>
              <div class="person-info">
                <div class="person-name">–õ–µ—Ä–∞</div>
                <div class="person-amount income" id="leraIncome">0 z≈Ç</div>
                <div class="person-period">–¥–æ—Ö–æ–¥ –∑–∞ –º–µ—Å—è—Ü</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- –ë—ã—Å—Ç—Ä—ã–µ —à–∞–±–ª–æ–Ω—ã -->
      <div class="quick-templates-section">
        <div class="quick-templates-header">
          <h3>‚ö° –ë—ã—Å—Ç—Ä—ã–µ —à–∞–±–ª–æ–Ω—ã</h3>
          <div style="display: flex; gap: 10px">
            <button
              class="btn-create-template"
              onclick="openModal('templateModal')"
            >
              ‚ûï –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω
            </button>
            <button
              class="btn-edit-templates"
              onclick="openModal('editTemplatesModal'); loadEditTemplatesList();"
              style="
                background: var(--warning);
                color: white;
                border: none;
                padding: 8px 12px;
                border-radius: 6px;
                cursor: pointer;
              "
            >
              ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
            </button>
          </div>
        </div>
        <div id="quickTemplates" class="quick-templates-grid">
          <!-- –®–∞–±–ª–æ–Ω—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
      </div>

      <div class="three-column-panels">
        <!-- –ö–æ–ª–æ–Ω–∫–∞ 1: –û–ø–µ—Ä–∞—Ü–∏–∏ -->
        <div class="panel-column operations-column">
          <div class="panel-header">
            <h2>üìã –û–ø–µ—Ä–∞—Ü–∏–∏</h2>
            <button
              class="collapse-btn"
              data-collapse="transactions"
              title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å"
            >
              ‚ñº
            </button>
          </div>
          <div class="card transactions-card">
            <div id="collapse-transactions">
              <!-- –û–ø–µ—Ä–∞—Ü–∏–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É, —Å—Ç–∞—Ä—ã–µ —Å–Ω–∏–∑—É -->
              <div class="transactions-list" id="transactionsList">
                <!-- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
              </div>
            </div>
          </div>
        </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞ -->
        <div class="panel-column budget-column">
          <div class="panel-header">
            <h2>üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞</h2>
            <button
              class="collapse-btn"
              data-collapse="budget-usage"
              title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å"
            >
              ‚ñº
            </button>
          </div>
          
          <div class="card budget-usage-card">
            <div id="collapse-budget-usage">
              <div id="budgetProgressBars">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã -->
              </div>
            </div>
          </div>
        </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 3: –¶–µ–ª–∏ -->
        <div class="panel-column goals-column">
          <div class="panel-header">
            <h2>üéØ –ù–∞—à–∏ —Ü–µ–ª–∏</h2>
            <button
              class="collapse-btn"
              data-collapse="goals"
              title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å"
            >
              ‚ñº
            </button>
          </div>
          <div class="card goals-card">
            <div id="collapse-goals">
              <div id="goalsList" class="goals-container">
                <!-- –¶–µ–ª–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
              </div>

              <!-- Empty state –¥–ª—è —Ü–µ–ª–µ–π -->
              <div id="goalsEmptyState" class="goals-empty-state">
                <div class="empty-state-icon">üéØ</div>
                <h4>–ù–∞—á–Ω–∏—Ç–µ –∫–æ–ø–∏—Ç—å –Ω–∞ –º–µ—á—Ç—É!</h4>
                <p>
                  –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é —Ü–µ–ª—å –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å
                  –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π
                </p>
                <button
                  class="btn-add-goal"
                  onclick="openModal('addGoalModal')"
                >
                  ‚ú® –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é —Ü–µ–ª—å
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="incomeModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('incomeModal')">
          &times;
        </button>
        <h2>üí∞ –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥</h2>
        <form id="incomeForm">
          <div class="form-group">
            <label>–°—É–º–º–∞ (z≈Ç)</label>
            <input
              type="number"
              class="form-control"
              id="incomeAmount"
              required
              min="0.01"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–ö—Ç–æ –ø–æ–ª—É—á–∏–ª?</label>
            <select class="form-control" id="incomePerson" required>
              <option value="arthur">–ê—Ä—Ç—É—Ä</option>
              <option value="lera">–õ–µ—Ä–∞</option>
              <option value="common">–û–±—â–∏–π</option>
            </select>
          </div>
          <div class="form-group">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ—Ö–æ–¥–∞</label>
            <select class="form-control" id="incomeCategory" required>
              <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </select>
          </div>
          <div class="form-group">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <input
              type="text"
              class="form-control"
              id="incomeDescription"
              placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–∞"
            />
          </div>
          <div class="form-group">
            <label>–î–∞—Ç–∞</label>
            <input type="date" class="form-control" id="incomeDate" required />
          </div>
          <button type="submit" class="btn btn-success" style="width: 100%">
            –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥
          </button>
        </form>
      </div>
    </div>

    <div id="expenseModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('expenseModal')">
          &times;
        </button>
        <h2>üí∏ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h2>
        <form id="expenseForm">
          <div class="form-group">
            <label>–°—É–º–º–∞ (z≈Ç)</label>
            <input
              type="number"
              class="form-control"
              id="expenseAmount"
              required
              min="0.01"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–ö—Ç–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª?</label>
            <select class="form-control" id="expensePerson" required>
              <option value="arthur">–ê—Ä—Ç—É—Ä</option>
              <option value="lera">–õ–µ—Ä–∞</option>
              <option value="common">–û–±—â–∏–π</option>
            </select>
          </div>
          <div class="form-group">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ä–∞—Å—Ö–æ–¥–∞</label>
            <select class="form-control" id="expenseCategory" required>
              <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </select>
          </div>
          <div class="form-group">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <input
              type="text"
              class="form-control"
              id="expenseDescription"
              placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞"
            />
          </div>
          <div class="form-group">
            <label>–î–∞—Ç–∞</label>
            <input type="date" class="form-control" id="expenseDate" required />
          </div>
          <button type="submit" class="btn btn-danger" style="width: 100%">
            –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥
          </button>
        </form>
      </div>
    </div>

    <div id="editTransactionModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('editTransactionModal')">
          &times;
        </button>
        <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</h2>
        <form id="editTransactionForm">
          <input type="hidden" id="editTransactionId" />
          <div class="form-group">
            <label>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
            <select class="form-control" id="editTransactionType" required>
              <option value="income">–î–æ—Ö–æ–¥</option>
              <option value="expense">–†–∞—Å—Ö–æ–¥</option>
            </select>
          </div>
          <div class="form-group">
            <label>–°—É–º–º–∞ (z≈Ç)</label>
            <input
              type="number"
              class="form-control"
              id="editTransactionAmount"
              required
              min="0.01"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–ö—Ç–æ?</label>
            <select class="form-control" id="editTransactionPerson" required>
              <option value="arthur">–ê—Ä—Ç—É—Ä</option>
              <option value="lera">–õ–µ—Ä–∞</option>
              <option value="common">–û–±—â–∏–π</option>
            </select>
          </div>
          <div class="form-group">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
            <select class="form-control" id="editTransactionCategory" required>
              <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </select>
          </div>
          <div class="form-group">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <input
              type="text"
              class="form-control"
              id="editTransactionDescription"
              placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"
            />
          </div>
          <div class="form-group">
            <label>–î–∞—Ç–∞</label>
            <input
              type="date"
              class="form-control"
              id="editTransactionDate"
              required
            />
          </div>
          <div class="form-group" style="display: flex; gap: 10px">
            <button type="submit" class="btn btn-primary" style="flex: 1">
              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
            <button
              type="button"
              class="btn btn-danger"
              onclick="deleteTransaction()"
              style="flex: 1"
            >
              –£–¥–∞–ª–∏—Ç—å
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="categoriesModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('categoriesModal')">
          &times;
        </button>
        <h2>üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h2>

        <div class="category-management">
          <h3 style="margin-bottom: 15px; color: var(--text-muted)">
            –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
          </h3>
          <div class="category-input-group">
            <input
              type="text"
              class="form-control"
              id="newCategoryName"
              placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
            />
            <select
              class="form-control"
              id="newCategoryType"
              style="width: 140px"
            >
              <option value="income">–î–æ—Ö–æ–¥</option>
              <option value="expense">–†–∞—Å—Ö–æ–¥</option>
            </select>
            <input
              type="color"
              class="form-control"
              id="newCategoryColor"
              value="#6d28d9"
              style="width: 60px; padding: 5px"
            />
            <button
              type="button"
              class="btn btn-primary"
              onclick="addCustomCategory()"
              style="padding: 8px 12px"
            >
              –î–æ–±–∞–≤–∏—Ç—å
            </button>
          </div>

          <h3 style="margin: 20px 0 10px 0; color: var(--text-muted)">
            –í—ã–±–µ—Ä–∏—Ç–µ –∏–∫–æ–Ω–∫—É
          </h3>
          <div class="icon-picker" id="iconPicker">
            <!-- –ò–∫–æ–Ω–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
          </div>

          <h3 style="margin: 20px 0 10px 0; color: var(--text-muted)">
            –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
          </h3>
          <div id="allCategoriesList">
            <!-- –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
          </div>
        </div>
      </div>
    </div>

    <div id="editCategoryModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('editCategoryModal')">
          &times;
        </button>
        <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h2>
        <form id="editCategoryForm">
          <input type="hidden" id="editCategoryId" />
          <input type="hidden" id="editCategoryOriginalName" />
          <input type="hidden" id="editCategoryOriginalType" />
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
            <input
              type="text"
              class="form-control"
              id="editCategoryName"
              required
            />
          </div>
          <div class="form-group">
            <label>–¢–∏–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
            <select class="form-control" id="editCategoryType" required>
              <option value="income">–î–æ—Ö–æ–¥</option>
              <option value="expense">–†–∞—Å—Ö–æ–¥</option>
            </select>
          </div>
          <div class="form-group">
            <label>–¶–≤–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
            <input
              type="color"
              class="form-control"
              id="editCategoryColor"
              style="height: 50px"
            />
          </div>
          <div class="form-group">
            <label>–ò–∫–æ–Ω–∫–∞</label>
            <div class="icon-picker" id="editIconPicker">
              <!-- –ò–∫–æ–Ω–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
          </div>
          <div class="form-group">
            <label>–õ–∏–º–∏—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)</label>
            <input
              type="number"
              class="form-control"
              id="editCategoryLimit"
              placeholder="–ë–µ–∑ –ª–∏–º–∏—Ç–∞"
              min="0"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–ü–µ—Ä–∏–æ–¥ –ª–∏–º–∏—Ç–∞</label>
            <select class="form-control" id="editCategoryLimitPeriod">
              <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
              <option value="weekly">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
              <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ</option>
            </select>
          </div>
          <div class="form-group" style="display: flex; gap: 10px">
            <button type="submit" class="btn btn-primary" style="flex: 1">
              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
            <button
              type="button"
              class="btn btn-danger"
              onclick="deleteCategory()"
              style="flex: 1"
            >
              –£–¥–∞–ª–∏—Ç—å
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="editGoalModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('editGoalModal')">
          &times;
        </button>
        <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª—å</h2>
        <form id="editGoalForm">
          <input type="hidden" id="editGoalId" />
          <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏</label>
            <input
              type="text"
              class="form-control"
              id="editGoalName"
              required
            />
          </div>
          <div class="form-group">
            <label>–°—É–º–º–∞ —Ü–µ–ª–∏ (z≈Ç)</label>
            <input
              type="number"
              class="form-control"
              id="editGoalAmount"
              required
              min="0.01"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–¢–µ–∫—É—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è (z≈Ç)</label>
            <input
              type="number"
              class="form-control"
              id="editGoalCurrent"
              min="0"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label>–î–∞—Ç–∞ —Ü–µ–ª–∏</label>
            <input
              type="date"
              class="form-control"
              id="editGoalDate"
              required
            />
          </div>
          <div class="form-group">
            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ü–µ–ª–∏</label>
            <select class="form-control" id="editGoalCategory">
              <option value="savings">–°–±–µ—Ä–µ–∂–µ–Ω–∏—è</option>
              <option value="travel">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</option>
              <option value="home">–î–æ–º</option>
              <option value="car">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</option>
              <option value="other">–î—Ä—É–≥–æ–µ</option>
            </select>
          </div>
          <div class="form-group" style="display: flex; gap: 10px">
            <button type="submit" class="btn btn-primary" style="flex: 1">
              –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
            <button
              type="button"
              class="btn btn-danger"
              onclick="deleteGoal()"
              style="flex: 1"
            >
              –£–¥–∞–ª–∏—Ç—å
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="analyticsModal" class="modal">
      <div class="modal-content" style="max-width: 800px">
        <button class="close" onclick="closeModal('analyticsModal')">
          &times;
        </button>
        <h2>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</h2>
        <div class="tabs">
          <div class="tab active" onclick="switchAnalyticsTab('daily-income')">
            –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –¥–æ—Ö–æ–¥—ã
          </div>
          <div class="tab" onclick="switchAnalyticsTab('history')">
            –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
          </div>
        </div>

        <div id="analyticsDailyIncome" class="analytics-tab active">
          <h3>üìà –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –¥–æ—Ö–æ–¥—ã</h3>
          <div class="daily-income-stats">
            <div class="daily-stat">
              <div>–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥/–¥–µ–Ω—å</div>
              <div class="stat-value income" id="avgDailyIncomeAnalytics">
                0 z≈Ç
              </div>
              <div>–∑–∞ 30 –¥–Ω–µ–π</div>
            </div>
            <div class="daily-stat">
              <div>–î–æ—Ö–æ–¥ —Å–µ–≥–æ–¥–Ω—è</div>
              <div class="stat-value income" id="todayIncomeAnalytics">
                0 z≈Ç
              </div>
              <div id="todayDateAnalytics">3 –æ–∫—Ç—è–±—Ä—è 2025</div>
            </div>
          </div>
          <div class="chart-container" style="margin-top: 20px">
            <canvas
              id="incomeChartAnalytics"
              style="max-height: 400px"
            ></canvas>
          </div>
          <div
            style="
              margin-top: 20px;
              padding: 15px;
              background: rgba(34, 197, 94, 0.1);
              border-radius: 8px;
            "
          >
            <p style="margin: 0; color: var(--text-muted); font-size: 0.9em">
              üí° <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> –ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏
              –≥—Ä–∞—Ñ–∏–∫ –≤–∞—à–∏—Ö –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –¥–æ—Ö–æ–¥–æ–≤. –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
              –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
            </p>
          </div>
        </div>

        <!-- –ù–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞: –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
        <div id="analyticsHistory" class="analytics-tab">
          <div class="history-filters">
            <h3>üîç –§–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫</h3>

            <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
            <div class="analytics-filters-panel">
              <div class="filters-grid-analytics">
                <div class="filter-group-analytics">
                  <label class="filter-label-analytics">üìÖ –ü–µ—Ä–∏–æ–¥</label>
                  <select
                    id="analyticsFilterPeriod"
                    class="filter-control-analytics"
                  >
                    <option value="all">–í—Å–µ –≤—Ä–µ–º—è</option>
                    <option value="current-month">–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</option>
                    <option value="last-month">–ü—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü</option>
                    <option value="current-year">–¢–µ–∫—É—â–∏–π –≥–æ–¥</option>
                    <option value="custom">–í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥</option>
                  </select>
                </div>

                <div
                  class="filter-group-analytics"
                  id="customPeriodGroup"
                  style="display: none"
                >
                  <label class="filter-label-analytics">üìÖ –û—Ç - –î–æ</label>
                  <div style="display: flex; gap: 8px">
                    <input
                      type="date"
                      id="analyticsDateFrom"
                      class="filter-control-analytics"
                    />
                    <input
                      type="date"
                      id="analyticsDateTo"
                      class="filter-control-analytics"
                    />
                  </div>
                </div>

                <div class="filter-group-analytics">
                  <label class="filter-label-analytics">üîç –ü–æ–∏—Å–∫</label>
                  <input
                    type="text"
                    id="analyticsSearchText"
                    class="filter-control-analytics"
                    placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ..."
                  />
                </div>

                <div class="filter-group-analytics">
                  <label class="filter-label-analytics">üìã –¢–∏–ø</label>
                  <select
                    id="analyticsFilterType"
                    class="filter-control-analytics"
                  >
                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                    <option value="income">üí∞ –î–æ—Ö–æ–¥—ã</option>
                    <option value="expense">üí∏ –†–∞—Å—Ö–æ–¥—ã</option>
                  </select>
                </div>

                <div class="filter-group-analytics">
                  <label class="filter-label-analytics">üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                  <select
                    id="analyticsFilterCategory"
                    class="filter-control-analytics"
                  >
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                  </select>
                </div>

                <div class="filter-group-analytics">
                  <label class="filter-label-analytics">üë§ –ö—Ç–æ –¥–æ–±–∞–≤–∏–ª</label>
                  <select
                    id="analyticsFilterPerson"
                    class="filter-control-analytics"
                  >
                    <option value="">–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏</option>
                  </select>
                </div>

                <div class="filter-group-analytics">
                  <label class="filter-label-analytics">üíµ –°—É–º–º–∞</label>
                  <div class="filter-amount-inputs">
                    <input
                      type="number"
                      id="analyticsAmountFrom"
                      class="filter-control-analytics"
                      placeholder="–û—Ç"
                      min="0"
                    />
                    <input
                      type="number"
                      id="analyticsAmountTo"
                      class="filter-control-analytics"
                      placeholder="–î–æ"
                      min="0"
                    />
                  </div>
                </div>

                <div class="filter-group-analytics">
                  <label class="filter-label-analytics">üîÑ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                  <select id="analyticsSortBy" class="filter-control-analytics">
                    <option value="date-desc">–ü–æ –¥–∞—Ç–µ ‚Üì</option>
                    <option value="date-asc">–ü–æ –¥–∞—Ç–µ ‚Üë</option>
                    <option value="sum-desc">–ü–æ —Å—É–º–º–µ ‚Üì</option>
                    <option value="sum-asc">–ü–æ —Å—É–º–º–µ ‚Üë</option>
                    <option value="category">–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                  </select>
                </div>
              </div>

              <div class="analytics-filter-actions">
                <button
                  class="btn btn-primary"
                  onclick="applyAnalyticsFilters()"
                >
                  üîç –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                </button>
                <button
                  class="btn btn-secondary"
                  onclick="clearAnalyticsFilters()"
                >
                  üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å
                </button>
                <button
                  class="btn btn-success"
                  onclick="exportAnalyticsHistory()"
                >
                  üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                </button>
              </div>
            </div>
          </div>

          <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
          <div class="analytics-history-container">
            <div class="analytics-history-header">
              <h3>üìã –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h3>
              <div class="analytics-stats">
                <span id="analyticsTotal">–í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: 0</span>
                <span id="analyticsIncomeTotal">–î–æ—Ö–æ–¥—ã: 0 z≈Ç</span>
                <span id="analyticsExpenseTotal">–†–∞—Å—Ö–æ–¥—ã: 0 z≈Ç</span>
              </div>
            </div>

            <div
              class="analytics-transactions-list"
              id="analyticsTransactionsList"
            >
              <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
              <div style="padding: 20px; text-align: center"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
    <div id="recurringModal" class="modal">
      <div class="modal-content" style="max-width: 900px">
        <button class="close" onclick="closeModal('recurringModal')">
          &times;
        </button>
        <h2>üîÑ –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏</h2>

        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
          "
        >
          <p style="margin: 0; color: var(--text-secondary)">
            –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ, –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∏–ª–∏ –µ–∂–µ–≥–æ–¥–Ω—ã–µ
            –æ–ø–µ—Ä–∞—Ü–∏–∏
          </p>
          <button
            class="btn btn-primary"
            onclick="openModal('addRecurringModal')"
          >
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é
          </button>
        </div>

        <div id="recurringList">
          <!-- –°–ø–∏—Å–æ–∫ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–π—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
    <div id="addRecurringModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('addRecurringModal')">
          &times;
        </button>
        <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â—É—é—Å—è –æ–ø–µ—Ä–∞—Ü–∏—é</h2>

        <form onsubmit="handleRecurringSubmit(event)">
          <div class="form-group">
            <label for="recurringType">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:</label>
            <select
              id="recurringType"
              class="form-control"
              onchange="updateRecurringCategories()"
              required
            >
              <option value="income">üí∞ –î–æ—Ö–æ–¥</option>
              <option value="expense">üí∏ –†–∞—Å—Ö–æ–¥</option>
            </select>
          </div>

          <div class="form-group">
            <label for="recurringName">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input
              type="text"
              id="recurringName"
              class="form-control"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞—Ä–ø–ª–∞—Ç–∞, –ê—Ä–µ–Ω–¥–∞ –∂–∏–ª—å—è"
              required
            />
          </div>

          <div class="form-group">
            <label for="recurringAmount">–°—É–º–º–∞:</label>
            <input
              type="number"
              id="recurringAmount"
              class="form-control"
              placeholder="0"
              required
              step="0.01"
              min="0"
            />
          </div>

          <div class="form-group">
            <label for="recurringCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
            <select id="recurringCategory" class="form-control" required>
              <!-- –û–ø—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </select>
          </div>

          <div class="form-group">
            <label for="recurringPerson">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</label>
            <select id="recurringPerson" class="form-control" required>
              <option value="arthur">–ê—Ä—Ç—É—Ä</option>
              <option value="lera">–õ–µ—Ä–∞</option>
            </select>
          </div>

          <div class="form-group">
            <label for="recurringDescription">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
            <input
              type="text"
              id="recurringDescription"
              class="form-control"
              placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ"
            />
          </div>

          <div class="form-group">
            <label for="recurringFrequency">–ß–∞—Å—Ç–æ—Ç–∞:</label>
            <select
              id="recurringFrequency"
              class="form-control"
              onchange="updateRecurringFrequencyOptions()"
              required
            >
              <option value="monthly">üìÖ –ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
              <option value="weekly">üìÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
              <option value="yearly">üìÖ –ï–∂–µ–≥–æ–¥–Ω–æ</option>
            </select>
          </div>

          <div id="recurringFrequencyOptions">
            <!-- –û–ø—Ü–∏–∏ —á–∞—Å—Ç–æ—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%">
            –°–æ–∑–¥–∞—Ç—å –ø–æ–≤—Ç–æ—Ä—è—é—â—É—é—Å—è –æ–ø–µ—Ä–∞—Ü–∏—é
          </button>
        </form>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–∞ -->
    <div id="templateModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('templateModal')">
          &times;
        </button>
        <h2>‚ö° –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω –æ–ø–µ—Ä–∞—Ü–∏–∏</h2>
        <form onsubmit="handleTemplateSubmit(event)">
          <div class="form-group">
            <label for="templateType">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:</label>
            <select
              id="templateType"
              class="form-control"
              onchange="updateTemplateCategories()"
              required
            >
              <option value="income">üí∞ –î–æ—Ö–æ–¥</option>
              <option value="expense">üí∏ –†–∞—Å—Ö–æ–¥</option>
            </select>
          </div>

          <div class="form-group">
            <label for="templateName">–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞:</label>
            <input
              type="text"
              id="templateName"
              class="form-control"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞—Ä–ø–ª–∞—Ç–∞, –ü—Ä–æ–¥—É–∫—Ç—ã, –ö–æ–º–º—É–Ω–∞–ª–∫–∞"
              required
            />
          </div>

          <div class="form-group">
            <label for="templateAmount">–°—É–º–º–∞:</label>
            <input
              type="number"
              id="templateAmount"
              class="form-control"
              placeholder="0"
              required
              step="0.01"
              min="0"
            />
          </div>

          <div class="form-group">
            <label for="templateCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
            <select id="templateCategory" class="form-control" required>
              <!-- –û–ø—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </select>
          </div>

          <div class="form-group">
            <label for="templatePerson">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</label>
            <select id="templatePerson" class="form-control" required>
              <option value="arthur">–ê—Ä—Ç—É—Ä</option>
              <option value="lera">–õ–µ—Ä–∞</option>
            </select>
          </div>

          <div class="form-group">
            <label for="templateDescription">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
            <input
              type="text"
              id="templateDescription"
              class="form-control"
              placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏"
            />
          </div>

          <div class="form-group">
            <label for="templateIcon">–ò–∫–æ–Ω–∫–∞:</label>
            <select id="templateIcon" class="form-control">
              <option value="üí∞">üí∞ –î–µ–Ω—å–≥–∏</option>
              <option value="üíº">üíº –†–∞–±–æ—Ç–∞</option>
              <option value="üè†">üè† –î–æ–º</option>
              <option value="üõí">üõí –ü—Ä–æ–¥—É–∫—Ç—ã</option>
              <option value="üöó">üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</option>
              <option value="‚ö°">‚ö° –ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ</option>
              <option value="üé¨">üé¨ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
              <option value="üì±">üì± –°–≤—è–∑—å</option>
              <option value="üíª">üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
              <option value="üëï">üëï –û–¥–µ–∂–¥–∞</option>
              <option value="üè•">üè• –ó–¥–æ—Ä–æ–≤—å–µ</option>
              <option value="üéì">üéì –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
              <option value="üéÅ">üéÅ –ü–æ–¥–∞—Ä–∫–∏</option>
            </select>
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%">
            –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω
          </button>
        </form>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ -->
    <div id="editTemplatesModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('editTemplatesModal')">
          &times;
        </button>
        <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã</h2>
        <p style="color: var(--text-muted)">
          –ò–∑–º–µ–Ω—è–π—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —Å—É–º–º—ã –≤–∞—à–∏—Ö –±—ã—Å—Ç—Ä—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
        </p>

        <div id="editTemplatesList">
          <!-- –°–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ -->
    <div id="saveFilterModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('saveFilterModal')">
          &times;
        </button>
        <h2>üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</h2>
        <p style="color: var(--text-muted)">
          –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        </p>
        <form onsubmit="saveFilterSubmit(event)">
          <div class="form-group">
            <label for="filterName">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞:</label>
            <input
              type="text"
              id="filterName"
              class="form-control"
              placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–¥—É–∫—Ç—ã –∑–∞ –º–µ—Å—è—Ü"
              required
            />
          </div>

          <div class="form-group">
            <label for="filterDescription">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
            <input
              type="text"
              id="filterDescription"
              class="form-control"
              placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞"
            />
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%">
            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
          </button>
        </form>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
    <div id="savedFiltersModal" class="modal">
      <div class="modal-content" style="max-width: 600px">
        <button class="close" onclick="closeModal('savedFiltersModal')">
          &times;
        </button>
        <h2>üìÅ –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã</h2>
        <p style="color: var(--text-muted)">
          –ë—ã—Å—Ç—Ä–æ –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
        </p>

        <div id="savedFiltersList" class="saved-filters-list">
          <!-- –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>

        <div style="margin-top: 20px; text-align: center">
          <button
            class="btn btn-secondary"
            onclick="closeModal('savedFiltersModal')"
          >
            –ó–∞–∫—Ä—ã—Ç—å
          </button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö -->
    <div id="exportModal" class="modal">
      <div class="modal-content" style="max-width: 500px">
        <button class="close" onclick="closeModal('exportModal')">
          &times;
        </button>
        <h2>üìä –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
        <p style="color: var(--text-muted)">
          –í—ã–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ Excel –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
        </p>

        <div class="export-options">
          <h3>–ß—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:</h3>
          <div class="export-data-types">
            <label class="checkbox-label">
              <input type="checkbox" id="exportTransactions" checked />
              üìã –û–ø–µ—Ä–∞—Ü–∏–∏
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="exportGoals" />
              üéØ –¶–µ–ª–∏
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="exportCategories" />
              üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="exportRecurring" />
              üîÑ –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏
            </label>
          </div>

          <h3>–ü–µ—Ä–∏–æ–¥:</h3>
          <div class="export-period">
            <label class="radio-label">
              <input type="radio" name="exportPeriod" value="all" checked />
              –í—Å–µ –≤—Ä–µ–º—è
            </label>
            <label class="radio-label">
              <input type="radio" name="exportPeriod" value="year" />
              –¢–µ–∫—É—â–∏–π –≥–æ–¥
            </label>
            <label class="radio-label">
              <input type="radio" name="exportPeriod" value="month" />
              –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
            </label>
            <label class="radio-label">
              <input type="radio" name="exportPeriod" value="custom" />
              –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥
            </label>
          </div>

          <div id="customPeriod" class="custom-period" style="display: none">
            <div class="period-row">
              <div class="period-field">
                <label for="exportDateFrom">–î–∞—Ç–∞ —Å:</label>
                <input type="date" id="exportDateFrom" class="form-control" />
              </div>
              <div class="period-field">
                <label for="exportDateTo">–î–∞—Ç–∞ –ø–æ:</label>
                <input type="date" id="exportDateTo" class="form-control" />
              </div>
            </div>
          </div>

          <h3>–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:</h3>
          <div class="export-formats">
            <button
              class="btn btn-primary export-format-btn"
              onclick="exportData('csv')"
            >
              üìÑ CSV (Excel, Google Sheets)
            </button>
            <button
              class="btn btn-success export-format-btn"
              onclick="exportData('excel')"
            >
              üìä Excel (.xlsx)
            </button>
            <button
              class="btn btn-info export-format-btn"
              onclick="exportData('json')"
            >
              üîß JSON (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
            </button>
          </div>

          <div class="export-info">
            <p
              style="
                font-size: 0.9em;
                color: var(--text-muted);
                margin-top: 15px;
              "
            >
              üí° <strong>–°–æ–≤–µ—Ç:</strong> CSV —Ñ–∞–π–ª—ã –ª–µ–≥–∫–æ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ Excel,
              Google Sheets –∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–ë—é–¥–∂–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º" -->
    <div id="budgetCategoriesModal" class="modal">
      <div class="modal-content">
        <button class="close" onclick="closeModal('budgetCategoriesModal')">
          &times;
        </button>
        <h2>üìä –ë—é–¥–∂–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h2>

        <div class="budget-categories-content">
          <div id="categoriesList">
            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
          </div>

          <div class="budget-settings">
            <h3
              style="
                font-size: 1rem;
                margin-bottom: 10px;
                color: var(--text-muted);
              "
            >
              –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—é–¥–∂–µ—Ç–∞
            </h3>
            <div class="budget-input-group">
              <input
                type="number"
                class="form-control"
                id="monthlyBudgetInput"
                placeholder="–ú–µ—Å—è—á–Ω—ã–π –±—é–¥–∂–µ—Ç"
                min="0"
                step="100"
              />
              <button
                class="btn btn-primary"
                onclick="updateMonthlyBudget()"
                style="padding: 8px 12px"
              >
                –û–±–Ω–æ–≤–∏—Ç—å
              </button>
            </div>
            <div
              style="
                font-size: 0.8em;
                color: var(--text-muted);
                margin-top: 5px;
              "
            >
              –¢–µ–∫—É—â–∏–π –±—é–¥–∂–µ—Ç: <span id="currentBudgetDisplay">5000 z≈Ç</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤ -->

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
    <div id="confirmModal" class="modal">
      <div class="modal-content" style="max-width: 500px">
        <h2 id="confirmTitle">ü§î –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h2>
        <p id="confirmMessage" style="color: var(--text-muted); margin: 20px 0">
          –í—ã —É–≤–µ—Ä–µ–Ω—ã?
        </p>
        <div style="display: flex; gap: 15px; justify-content: flex-end">
          <button id="confirmCancel" class="btn btn-secondary">
            ‚ùå –û—Ç–º–µ–Ω–∞
          </button>
          <button id="confirmOk" class="btn btn-primary">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ -->
    <div id="promptModal" class="modal">
      <div class="modal-content" style="max-width: 500px">
        <h2 id="promptTitle">üí¨ –í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ</h2>
        <p id="promptMessage" style="color: var(--text-muted); margin: 15px 0">
          –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
        </p>
        <div style="margin: 20px 0">
          <input
            type="text"
            id="promptInput"
            class="form-control"
            placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ..."
            style="width: 100%; padding: 12px; margin-bottom: 10px"
          />
          <small
            id="promptHint"
            style="color: var(--text-muted); display: block"
          ></small>
        </div>
        <div style="display: flex; gap: 15px; justify-content: flex-end">
          <button id="promptCancel" class="btn btn-secondary">‚ùå –û—Ç–º–µ–Ω–∞</button>
          <button id="promptOk" class="btn btn-primary">‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="alertModal" class="modal" style="display: none;">
      <div class="modal-content" style="max-width: 450px">
        <h2 id="alertTitle">‚ÑπÔ∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</h2>
        <p
          id="alertMessage"
          style="color: var(--text-muted); margin: 20px 0; line-height: 1.5"
        >
          –°–æ–æ–±—â–µ–Ω–∏–µ
        </p>
        <div style="text-align: center">
          <button id="alertOk" class="btn btn-primary" style="min-width: 120px">
            ‚úÖ –ü–æ–Ω—è—Ç–Ω–æ
          </button>
        </div>
      </div>
    </div>

    <!-- PWA Scripts -->
    <script>
      // === PWA SERVICE WORKER –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø ===
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
              console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration.scope);
              
              // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
              registration.addEventListener('updatefound', () => {
                const newWorker = registration.installing;
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
                    if (window.notifications) {
                      window.notifications.show('üîÑ –î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', 'info', 5000);
                    }
                  }
                });
              });
            })
            .catch((error) => {
              console.log('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
            });
        });
      }
      
      // === PWA –£–°–¢–ê–ù–û–í–ö–ê ===
      let deferredPrompt;
      
      window.addEventListener('beforeinstallprompt', (e) => {
        console.log('üíæ PWA –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å');
        e.preventDefault();
        deferredPrompt = e;
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
        setTimeout(() => {
          if (window.notifications) {
            window.notifications.show('üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞!', 'info', 8000);
          }
        }, 3000);
      });
      
      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA
      window.installPWA = function() {
        console.log('üîß –ü–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA...');
        
        if (deferredPrompt) {
          deferredPrompt.prompt();
          deferredPrompt.userChoice.then((result) => {
            if (result.outcome === 'accepted') {
              console.log('‚úÖ PWA —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
              if (window.notifications) {
                window.notifications.show('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!', 'success');
              }
            } else {
              console.log('‚ùå –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞');
            }
            deferredPrompt = null;
          });
        } else {
          // Fallback –¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ beforeinstallprompt –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
          console.log('‚ö†Ô∏è –°–æ–±—ã—Ç–∏–µ beforeinstallprompt –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ');
          
          const isAndroid = /Android/i.test(navigator.userAgent);
          const isiOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
          const isChrome = /Chrome/i.test(navigator.userAgent) && !/Edge/i.test(navigator.userAgent);
          const isSafari = /Safari/i.test(navigator.userAgent) && !/Chrome/i.test(navigator.userAgent);
          const isOpera = /Opera|OPR/i.test(navigator.userAgent);
          const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
          
          if (isStandalone) {
            if (window.notifications) {
              window.notifications.show('‚ÑπÔ∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!', 'info');
            }
            return;
          }
          
          let message = 'üì± –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ:\n\n';
          
          if (isiOS) {
            if (isSafari) {
              message += 'üçé –î–ª—è iPhone/iPad –≤ Safari:\n';
              message += '1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" (‚¨ÜÔ∏è) –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞\n';
              message += '2. –ù–∞–π–¥–∏—Ç–µ "–ù–∞ —ç–∫—Ä–∞–Ω –î–æ–º–æ–π" –≤ —Å–ø–∏—Å–∫–µ\n';
              message += '3. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å"';
            } else {
              message += 'üçé –î–ª—è iPhone/iPad:\n';
              message += '1. –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ Safari (–Ω–µ Chrome!)\n';
              message += '2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" (‚¨ÜÔ∏è)\n';
              message += '3. –í—ã–±–µ—Ä–∏—Ç–µ "–ù–∞ —ç–∫—Ä–∞–Ω –î–æ–º–æ–π"';
            }
          } else if (isAndroid) {
            if (isOpera) {
              message += 'ü§ñ Opera –ø–ª–æ—Ö–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç PWA.\n';
              message += '–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:\n';
              message += '1. –û—Ç–∫—Ä—ã—Ç—å –≤ Google Chrome\n';
              message += '2. –ú–µ–Ω—é Chrome (‚ãÆ)\n';
              message += '3. "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"';
            } else if (isChrome) {
              message += 'ü§ñ –î–ª—è Android –≤ Chrome:\n';
              message += '1. –ù–∞–∂–º–∏—Ç–µ –º–µ–Ω—é Chrome (‚ãÆ)\n';
              message += '2. –í—ã–±–µ—Ä–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"\n';
              message += '3. –ù–∞–∂–º–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"\n';
              message += '\nüí° –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∞ –Ω–µ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ';
            } else {
              message += 'ü§ñ –î–ª—è Android:\n';
              message += '1. –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ Google Chrome\n';
              message += '2. –ù–∞–∂–º–∏—Ç–µ –º–µ–Ω—é Chrome (‚ãÆ)\n';
              message += '3. –í—ã–±–µ—Ä–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"';
            }
          } else {
            message += 'üíª –î–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:\n';
            message += '1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ Chrome –∏–ª–∏ Edge\n';
            message += '2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ\n';
            message += '3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é –±—Ä–∞—É–∑–µ—Ä–∞';
          }
          
          alert(message);
        }
      };
    </script>
    
  </body>
</html>
